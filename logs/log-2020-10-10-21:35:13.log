INFO: 2020-10-10 21:16:04,484: Reading pgn data from s3a://erops-chess/lichess-db/lichess_db_standard_rated_2016-1[0-1]* ..........
INFO: 2020-10-10 21:16:23,351: 15621379 total games loaded .............. 
INFO: 2020-10-10 21:17:31,245: 15621377 Games processed
INFO: 2020-10-10 21:17:31,245: Games DF Schema:
INFO: 2020-10-10 21:17:31,249: root
 |-- event: string (nullable = true)
 |-- gameid: string (nullable = true)
 |-- white: string (nullable = true)
 |-- black: string (nullable = true)
 |-- result: string (nullable = true)
 |-- whiteelo: integer (nullable = true)
 |-- blackelo: integer (nullable = true)
 |-- eco: string (nullable = true)
 |-- opening: string (nullable = true)
 |-- timecontrol: string (nullable = true)
 |-- termination: string (nullable = true)
 |-- moves: string (nullable = true)
 |-- datetime: string (nullable = false)
 |-- timestamp: long (nullable = true)

INFO: 2020-10-10 21:17:31,249: Top few rows of the games DF:
INFO: 2020-10-10 21:20:43,511: [Row(event='Rated Blitz game', gameid='lichess/007cmZZY', white='edas', black='eltauro', result='1-0', whiteelo=1801, blackelo=1587, eco='A40', opening='Horwitz Defense', timecontrol='180+0', termination='Normal', moves='1. d4 e6 2. Nf3 c5 3. b3 Nf6 4. e3 cxd4 5. exd4 Bb4+ 6. Bd2 Bxd2+ 7. Nbxd2 b6 8. Bd3 Bb7 9. Qe2 O-O 10. Ne4 Nc6 11. Nxf6+ Qxf6 12. Qe4 Na5 13. Qxh7# 1-0', datetime='2016.10.24 04:28:53', timestamp=1477283333), Row(event='Rated Blitz tournament https://lichess.org/tournament/KPpAqWZU', gameid='lichess/00DZZzZu', white='DavidPrieto', black='ChennaiExpress', result='0-1', whiteelo=2140, blackelo=1862, eco='B14', opening='Caro-Kann Defense: Panov Attack', timecontrol='180+0', termination='Normal', moves='1. e4 { [%eval 0.42] } 1... c6 { [%eval 0.37] } 2. d4 { [%eval 0.43] } 2... d5 { [%eval 0.4] } 3. exd5 { [%eval 0.25] } 3... cxd5 { [%eval 0.32] } 4. c4 { [%eval 0.28] } 4... Nf6 { [%eval 0.17] } 5. Nc3 { [%eval 0.25] } 5... e6 { [%eval 0.14] } 6. Nf3 { [%eval 0.14] } 6... Be7 { [%eval 0.22] } 7. Be2 { [%eval 0.01] } 7... a6 { [%eval 0.13] } 8. O-O { [%eval -0.06] } 8... dxc4 { [%eval 0.0] } 9. Bxc4 { [%eval 0.06] } 9... b5 { [%eval 0.01] } 10. Bb3 { [%eval 0.06] } 10... Bb7 { [%eval 0.18] } 11. a4 { [%eval -0.28] } 11... b4 { [%eval -0.29] } 12. Ne2 { [%eval -0.65] } 12... a5 { [%eval -0.22] } 13. Ng3 { [%eval -0.41] } 13... Nbd7 { [%eval -0.56] } 14. Ne5 { [%eval -0.55] } 14... Nxe5 { [%eval -0.39] } 15. dxe5 { [%eval -0.37] } 15... Qxd1 { [%eval -0.54] } 16. Rxd1 { [%eval -0.7] } 16... Nd5?! { [%eval -0.19] } 17. f4?! { [%eval -0.72] } 17... g6 { [%eval -0.75] } 18. Bd2?! { [%eval -1.49] } 18... Bc5+ { [%eval -1.29] } 19. Kh1 { [%eval -1.75] } 19... O-O?! { [%eval -0.79] } 20. Rac1 { [%eval -1.07] } 20... Rac8?! { [%eval -0.34] } 21. Ne4 { [%eval -0.41] } 21... Be7 { [%eval -0.41] } 22. Bxd5 { [%eval -0.62] } 22... Bxd5 { [%eval -0.61] } 23. Nd6 { [%eval -0.58] } 23... Rcd8 { [%eval -0.24] } 24. Nc4? { [%eval -3.1] } 24... Rc8? { [%eval -0.37] } 25. Nxa5?! { [%eval -0.99] } 25... Ra8?! { [%eval -0.1] } 26. Nc4 { [%eval -0.2] } 26... Rxa4?! { [%eval 0.3] } 27. Nb6 { [%eval 0.26] } 27... Ra5 { [%eval 0.32] } 28. Nxd5 { [%eval 0.0] } 28... Rxd5 { [%eval 0.02] } 29. Be3 { [%eval 0.02] } 29... Rfd8 { [%eval 0.06] } 30. Rxd5 { [%eval 0.0] } 30... Rxd5 { [%eval 0.0] } 31. Kg1 { [%eval 0.0] } 31... Rd3 { [%eval 0.18] } 32. Kf2 { [%eval 0.17] } 32... Kg7 { [%eval 0.29] } 33. Rc7 { [%eval 0.29] } 33... Bf8 { [%eval 0.35] } 34. g4 { [%eval 0.18] } 34... h6? { [%eval 1.45] } 35. Kf3? { [%eval 0.24] } 35... Rb3 { [%eval 0.32] } 36. Ke4 { [%eval 0.0] } 36... Rxb2 { [%eval 0.0] } 37. f5 { [%eval 0.0] } 37... gxf5+ { [%eval 0.0] } 38. gxf5 { [%eval 0.0] } 38... exf5+ { [%eval 0.0] } 39. Kxf5 { [%eval -0.08] } 39... Re2 { [%eval 0.0] } 40. Bf4 { [%eval -0.43] } 40... b3 { [%eval -0.43] } 41. Rb7 { [%eval -0.35] } 41... b2 { [%eval -0.35] } 42. h4? { [%eval -2.42] } 42... Ba3? { [%eval -0.63] } 43. Kg4?? { [%eval -7.65] } 43... Rg2+?? { [%eval -4.13] } 44. Kf3?? { [%eval -7.64] } 44... Rg1 { [%eval -6.46] } 45. e6? { [%eval -8.41] } 45... b1=Q { [%eval -7.74] } 46. Rxf7+? { [%eval #-9] } 46... Kg8 { [%eval #-8] } 47. Bxh6 { [%eval #-4] } 47... Rf1+?! { [%eval #-6] } 48. Kg4 { [%eval #-5] } 48... Rxf7?! { [%eval #-17] } 49. exf7+ { [%eval #-17] } 49... Kxf7 { [%eval #-22] } 0-1', datetime='2016.11.08 00:36:51', timestamp=1478565411), Row(event='Rated Blitz game', gameid='lichess/00EGZMFr', white='Gingerboy', black='saaat', result='1-0', whiteelo=1529, blackelo=1475, eco='D53', opening="Queen's Gambit Declined: 4.Bg5 Be7", timecontrol='300+0', termination='Normal', moves='1. d4 e6 2. c4 d5 3. Nc3 Nf6 4. Bg5 Be7 5. Nf3 Ne4 6. Bxe7 Qxe7 7. e3 Nxc3 8. bxc3 Nc6 9. cxd5 exd5 10. Bd3 Bg4 11. h3 Bxf3 12. Qxf3 O-O 13. Qxd5 Rad8 14. Qe4 Qa3 15. Qxh7# 1-0', datetime='2016.11.18 12:58:15', timestamp=1479473895)]
INFO: 2020-10-10 22:41:25,048: 1068052355 Moves processed
INFO: 2020-10-10 22:41:25,048: Moves DF Schema:
INFO: 2020-10-10 22:41:25,055: root
 |-- gameid: string (nullable = true)
 |-- result: string (nullable = true)
 |-- whiteelo: integer (nullable = true)
 |-- blackelo: integer (nullable = true)
 |-- timecontrol: string (nullable = true)
 |-- moves: string (nullable = false)
 |-- board_state: string (nullable = true)
 |-- move_no: integer (nullable = true)

INFO: 2020-10-10 22:41:25,055: Writing df to Cassandra table: chessdb.games .............
INFO: 2020-10-10 22:49:30,160: Writing complete .............
INFO: 2020-10-10 22:49:30,160: Writing df to Cassandra table: chessdb.moves .............
INFO: 2020-10-11 03:16:15,573: Writing complete .............
