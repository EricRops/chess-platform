INFO: 2020-10-13 02:30:33,718: Reading pgn data from s3a://erops-chess/chesscom-db/titled-games/IM-games* ..........
INFO: 2020-10-13 02:30:43,481: 1760859 total games loaded .............. 
INFO: 2020-10-13 02:31:04,503: 1688575 Games processed
INFO: 2020-10-13 02:31:04,503: Games DF Schema:
INFO: 2020-10-13 02:31:04,510: root
 |-- event: string (nullable = true)
 |-- white: string (nullable = true)
 |-- black: string (nullable = true)
 |-- result: string (nullable = true)
 |-- eco: string (nullable = true)
 |-- opening: string (nullable = true)
 |-- whiteelo: integer (nullable = true)
 |-- blackelo: integer (nullable = true)
 |-- timecontrol: string (nullable = true)
 |-- termination: string (nullable = true)
 |-- gameid: string (nullable = true)
 |-- moves: string (nullable = true)
 |-- datetime: string (nullable = false)
 |-- timestamp: long (nullable = false)

INFO: 2020-10-13 02:31:04,510: Top few rows of the games DF:
INFO: 2020-10-13 02:32:09,937: [Row(event="Let's Play!", white='nightarrow', black='wadsy27', result='0-1', eco='B49', opening='Sicilian-Defense-Taimanov-Bastrikov-Variation-6.Be3-a6-7.Be2', whiteelo=1527, blackelo=1719, timecontrol='1/86400', termination='wadsy27 won by resignation', gameid='chesscom/daily/game/232607076', moves='1. e4 {[%clk 23:59:39]} 1... c5 {[%clk 23:59:34]} 2. Nf3 {[%clk 23:59:22]} 2... e6 {[%clk 23:59:55]} 3. d4 {[%clk 23:59:47]} 3... cxd4 {[%clk 23:59:54]} 4. Nxd4 {[%clk 23:59:42]} 4... Nc6 {[%clk 23:59:53]} 5. Nc3 {[%clk 23:59:34]} 5... Qc7 {[%clk 23:59:38]} 6. Be2 {[%clk 23:59:31]} 6... a6 {[%clk 23:24:44]} 7. Be3 {[%clk 23:58:23]} 7... Nf6 {[%clk 23:59:47]} 8. O-O {[%clk 23:59:06]} 8... Bb4 {[%clk 23:59:32]} 9. f3 {[%clk 23:57:19]} 9... d5 {[%clk 23:57:51]} 10. exd5 {[%clk 23:58:42]} 10... exd5 {[%clk 23:59:34]} 11. Nxc6 {[%clk 23:57:46]} 11... bxc6 {[%clk 23:59:33]} 12. a3 {[%clk 23:59:31]} 12... Bd6 {[%clk 23:58:18]} 13. f4 {[%clk 23:58:36]} 13... O-O {[%clk 23:58:54]} 14. h3 {[%clk 23:58:58]} 14... Re8 {[%clk 23:59:00]} 15. Qd2 {[%clk 23:59:32]} 15... Bf5 {[%clk 23:58:54]} 16. Bd3 {[%clk 23:58:15]} 16... Bxd3 {[%clk 23:46:25]} 17. Qxd3 {[%clk 23:58:56]} 17... Ne4 {[%clk 23:58:41]} 18. Rad1 {[%clk 23:59:13]} 18... Qa5 {[%clk 23:35:07]} 19. f5 {[%clk 22:35:03]} 19... Nxc3 {[%clk 22:36:07]} 20. bxc3 {[%clk 22:14:33]} 20... f6 {[%clk 23:57:49]} 21. c4 {[%clk 23:55:52]} 21... Qxa3 {[%clk 23:59:03]} 22. cxd5 {[%clk 23:59:38]} 22... Rxe3 {[%clk 23:57:44]} 0-1', datetime='2019.07.22 12:41:33', timestamp=1563799293), Row(event='Candidates Matches >1900 - Round 4', white='Thomas_Fiebig', black='Kuzma40', result='0-1', eco='C17', opening='French-Defense-Winawer-Advance-Bogoljubov-Icelandic-Defense', whiteelo=2247, blackelo=2248, timecontrol='1/432000', termination='Kuzma40 won by resignation', gameid='chesscom/daily/game/233812042', moves='1. e4 {[%clk 106:27:13]} 1... e6 {[%clk 102:08:25]} 2. d4 {[%clk 110:24:31]} 2... d5 {[%clk 102:21:48]} 3. Nc3 {[%clk 119:10:29]} 3... Bb4 {[%clk 74:10:26]} 4. e5 {[%clk 117:02:08]} 4... c5 {[%clk 82:35:26]} 5. Bd2 {[%clk 116:01:06]} 5... Ne7 {[%clk 63:11:45]} 6. f4 {[%clk 117:57:17]} 6... Nf5 {[%clk 62:36:26]} 7. Nf3 {[%clk 118:34:41]} 7... a6 {[%clk 49:09:33]} 8. Ne2 {[%clk 110:04:55]} 8... Ne3 {[%clk 33:01:15]} 9. Qc1 {[%clk 117:50:48]} 9... Bxd2+ {[%clk 49:30:35]} 10. Qxd2 {[%clk 106:41:36]} 10... Nxf1 {[%clk 50:15:30]} 11. Rxf1 {[%clk 116:47:30]} 11... c4 {[%clk 105:34:45]} 12. g4 {[%clk 119:52:48]} 12... Nc6 {[%clk 76:36:16]} 13. Ng3 {[%clk 118:17:17]} 13... Qb6 {[%clk 36:52:34]} 14. c3 {[%clk 110:31:59]} 14... Bd7 {[%clk 58:46:08]} 15. f5 {[%clk 73:28:11]} 15... O-O-O {[%clk 51:05:52]} 16. Ng5 {[%clk 67:43:05]} 16... Rdf8 {[%clk 83:21:23]} 17. Nh5 {[%clk 112:10:12]} 17... h6 {[%clk 79:17:15]} 18. Nh3 {[%clk 118:36:27]} 18... exf5 {[%clk 68:42:36]} 19. gxf5 {[%clk 119:45:46]} 19... g6 {[%clk 31:35:35]} 20. Ng3 {[%clk 85:30:15]} 20... Qd8 {[%clk 32:58:22]} 21. O-O-O {[%clk 105:21:40]} 21... Ne7 {[%clk 51:26:47]} 22. f6 {[%clk 108:38:33]} 22... Bxh3 {[%clk 26:20:20]} 23. fxe7 {[%clk 119:56:32]} 23... Qxe7 {[%clk 119:53:55]} 24. Rf6 {[%clk 115:41:25]} 24... Be6 {[%clk 49:30:23]} 25. Rdf1 {[%clk 116:59:08]} 25... Kb8 {[%clk 31:30:14]} 26. a3 {[%clk 94:02:04]} 26... Ka8 {[%clk 69:31:12]} 27. Qg2 {[%clk 44:22:40]} 27... Qd7 {[%clk 28:42:26]} 28. R1f2 {[%clk 44:55:22]} 28... Rc8 {[%clk 31:09:36]} 29. Qf1 {[%clk 85:28:46]} 29... Rc7 {[%clk 91:12:00]} 30. Qh1 {[%clk 105:32:15]} 30... a5 {[%clk 32:39:41]} 31. Ne2 {[%clk 112:44:09]} 31... g5 {[%clk 27:32:01]} 32. Ng3 {[%clk 116:17:02]} 32... b5 {[%clk 34:52:59]} 33. Nf5 {[%clk 118:52:42]} 33... b4 {[%clk 27:12:16]} 34. axb4 {[%clk 116:26:41]} 34... axb4 {[%clk 114:58:18]} 35. Kd2 {[%clk 87:01:59]} 35... bxc3+ {[%clk 88:12:53]} 36. bxc3 {[%clk 110:30:32]} 36... Ra7 {[%clk 42:17:08]} 37. Nd6 {[%clk 119:51:05]} 37... Rb8 {[%clk 32:30:19]} 38. Ke3 {[%clk 19:12:22]} 38... Rb3 {[%clk 27:57:04]} 39. Rc2 {[%clk 115:27:48]} 39... Raa3 {[%clk 31:08:05]} 40. Kd2 {[%clk 115:14:44]} 40... Qa7 {[%clk 31:49:12]} 41. Rxh6 {[%clk 119:22:46]} 41... Kb8 {[%clk 45:59:52]} 42. Rh8+ {[%clk 0:00:00]} 42... Kc7 {[%clk 119:13:32]} 43. Rh7 {[%clk 119:49:32]} 43... Ra2 {[%clk 53:30:44]} 44. Qd1 {[%clk 117:10:55]} 44... Rxc2+ {[%clk 69:14:19]} 45. Qxc2 {[%clk 38:48:20]} 45... Qa1 {[%clk 118:53:15]} 46. Nxf7 {[%clk 47:43:04]} 46... Rb2 {[%clk 38:38:33]} 47. Nxg5+ {[%clk 117:57:09]} 47... Kb6 {[%clk 88:43:59]} 48. Rh6 {[%clk 104:08:43]} 48... Rxc2+ {[%clk 119:47:43]} 49. Kxc2 {[%clk 97:28:36]} 49... Qa2+ {[%clk 119:45:12]} 50. Kc1 {[%clk 119:58:48]} 50... Qa3+ {[%clk 119:48:21]} 51. Kc2 {[%clk 47:46:55]} 51... Qb3+ {[%clk 119:36:17]} 52. Kd2 {[%clk 83:43:07]} 52... Qb2+ {[%clk 119:18:56]} 53. Kd1 {[%clk 71:51:43]} 53... Qb1+ {[%clk 118:43:23]} 54. Ke2 {[%clk 71:11:30]} 54... Qd3+ {[%clk 110:56:57]} 55. Kf2 {[%clk 107:44:27]} 55... Qd2+ {[%clk 108:20:12]} 56. Kf3 {[%clk 65:00:58]} 56... Qxc3+ {[%clk 112:51:18]} 0-1', datetime='2019.08.06 04:22:10', timestamp=1565065330), Row(event='GTSAA - 2019 - Round 2', white='Chessparovik', black='BahadirOzen', result='1-0', eco='A07', opening='Kings-Indian-Attack-Yugoslav-Variation', whiteelo=1651, blackelo=1954, timecontrol='1/172800', termination='Chessparovik won by resignation', gameid='chesscom/daily/game/235697960', moves='1. Nf3 {[%clk 20:10:07]} 1... Nf6 {[%clk 4:15:19]} 2. g3 {[%clk 44:07:36]} 2... d5 {[%clk 3:32:30]} 3. Bg2 {[%clk 47:49:40]} 3... c6 {[%clk 13:55:42]} 4. O-O {[%clk 38:33:58]} 4... Bg4 {[%clk 11:13:44]} 5. c4 {[%clk 40:23:52]} 5... e6 {[%clk 6:50:36]} 6. d3 {[%clk 38:18:24]} 6... Nbd7 {[%clk 9:12:25]} 7. cxd5 {[%clk 39:02:46]} 7... cxd5 {[%clk 3:45:36]} 8. Qb3 {[%clk 37:58:10]} 8... Nc5 {[%clk 18:46:17]} 9. Qb5+ {[%clk 39:47:09]} 9... Nfd7 {[%clk 10:21:09]} 10. d4 {[%clk 47:51:34]} 10... a6 {[%clk 13:34:10]} 11. Qb4 {[%clk 47:57:04]} 11... Nd3 {[%clk 13:48:39]} 12. Qxb7 {[%clk 47:39:35]} 12... Nb4 {[%clk 31:26:43]} 13. Bf4 {[%clk 47:13:17]} 13... Nc2 {[%clk 4:04:51]} 14. Nc3 {[%clk 47:46:14]} 14... Nxa1 {[%clk 6:48:47]} 15. Rxa1 {[%clk 40:49:37]} 15... Be7 {[%clk 0:54:52]} 16. e4 {[%clk 47:01:56]} 16... dxe4 {[%clk 7:57:04]} 17. Ne5 {[%clk 42:54:20]} 17... Nxe5 {[%clk 7:34:48]} 18. Bxe5 {[%clk 47:48:53]} 18... O-O {[%clk 7:22:10]} 19. Qxe4 {[%clk 32:26:48]} 19... Bf5 {[%clk 1:05:55]} 20. Qxa8 {[%clk 42:58:09]} 20... Qxa8 {[%clk 6:40:36]} 21. Bxa8 {[%clk 45:35:15]} 21... Rxa8 {[%clk 2:50:15]} 22. d5 {[%clk 47:33:50]} 22... exd5 {[%clk 3:08:14]} 23. Nxd5 {[%clk 47:58:18]} 23... Bf8 {[%clk 4:46:47]} 24. Nc7 {[%clk 47:38:22]} 24... Rd8 {[%clk 5:16:50]} 25. Nxa6 {[%clk 47:34:46]} 25... f6 {[%clk 9:26:53]} 26. Bc3 {[%clk 39:50:26]} 26... h5 {[%clk 23:01:18]} 27. a4 {[%clk 47:39:40]} 27... h4 {[%clk 8:28:00]} 28. b4 {[%clk 40:38:10]} 28... h3 {[%clk 8:29:30]} 29. b5 {[%clk 44:31:56]} 29... Be4 {[%clk 15:19:22]} 30. Bb4 {[%clk 47:42:15]} 30... Bxb4 {[%clk 2:42:08]} 31. Nxb4 {[%clk 47:44:33]} 31... Rd4 {[%clk 8:13:45]} 32. Na6 {[%clk 41:53:18]} 32... Rd6 {[%clk 6:52:30]} 33. a5 {[%clk 39:41:38]} 33... Bd3 {[%clk 7:18:21]} 34. Rd1 {[%clk 43:54:46]} 34... Rd5 {[%clk 5:05:51]} 35. Nc7 {[%clk 24:08:58]} 35... Rc5 {[%clk 3:27:26]} 36. b6 {[%clk 36:46:25]} 36... Be4 {[%clk 7:49:20]} 37. a6 {[%clk 42:19:03]} 37... Rc2 {[%clk 6:01:44]} 38. Rb1 {[%clk 41:04:47]} 38... Ra2 {[%clk 8:26:54]} 39. b7 {[%clk 41:27:08]} 39... Bxb1 {[%clk 7:02:41]} 40. b8=Q+ {[%clk 38:43:28]} 1-0', datetime='2019.08.29 09:57:17', timestamp=1567072637)]
INFO: 2020-10-13 02:44:53,417: 136504551 Moves processed
INFO: 2020-10-13 02:44:53,417: Moves DF Schema:
INFO: 2020-10-13 02:44:53,417: root
 |-- gameid: string (nullable = true)
 |-- result: string (nullable = true)
 |-- whiteelo: integer (nullable = true)
 |-- blackelo: integer (nullable = true)
 |-- timecontrol: string (nullable = true)
 |-- moves: string (nullable = false)
 |-- board_state: string (nullable = true)
 |-- move_no: integer (nullable = true)

INFO: 2020-10-13 02:55:51,940: [Row(gameid='chesscom/daily/game/232607076', result='0-1', whiteelo=1527, blackelo=1719, timecontrol='1/86400', moves='e4', board_state='rnbqkbnr/pppppppp/8/8/8/8/PPPPPPPP/RNBQKBNR w KQkq', move_no=1), Row(gameid='chesscom/daily/game/232607076', result='0-1', whiteelo=1527, blackelo=1719, timecontrol='1/86400', moves='c5', board_state='rnbqkbnr/pppppppp/8/8/4P3/8/PPPP1PPP/RNBQKBNR b KQkq', move_no=2), Row(gameid='chesscom/daily/game/232607076', result='0-1', whiteelo=1527, blackelo=1719, timecontrol='1/86400', moves='Nf3', board_state='rnbqkbnr/pp1ppppp/8/2p5/4P3/8/PPPP1PPP/RNBQKBNR w KQkq', move_no=3)]
INFO: 2020-10-13 03:06:46,621: Writing df to Cassandra table: chessdb.games .............
INFO: 2020-10-13 03:08:31,389: Writing complete .............
INFO: 2020-10-13 03:08:31,390: Writing df to Cassandra table: chessdb.moves .............
INFO: 2020-10-13 03:43:43,871: Writing complete .............
